<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
<title>Exam Blogging - Fun with the Exponential Family - Stephen Malina</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="description"
    content="Disclaimer: Not a tutorial.

Not your average nuclear family.
- Kolmogorov

You won&rsquo;t believe these 5 exponential family tricks!
- BuzzFeed

Quick Intro
#

The exponential family is a collection of probability distributions that can all be cast in the same true form (technically there are a few different forms but they&rsquo;re equivalent under transformation). Surprisingly, the exponential family includes many of the probability distributions we know and love: ">
<link rel="canonical" href="http://localhost:1313/post/2020-03-06-exam-blogging-exponential-family-fun/" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/modern-normalize/1.1.0/modern-normalize.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />



<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link rel="preload" as="style"
      href="https://fonts.googleapis.com/css?family=Noto+Serif+SC|Noto+Emoji&display=swap" />
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Noto+Serif+SC|Noto+Emoji&display=swap"
      media="print" onload="this.media='all'" />
<noscript>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" />
</noscript>


  
  
    
      <link rel="stylesheet" href="http://localhost:1313/css/hugo-tufte.min.css">
    
  



  
  
    
      <link rel="stylesheet" href="http://localhost:1313/css/hugo-tufte-options.min.css">
    
  


<link rel="stylesheet" href="http://localhost:1313/css/hugo-tufte-override.css">

</head>
<body>


<article id="main">
  <section>
<h1 class="content-title">Exam Blogging - Fun with the Exponential Family&nbsp;:: Draft</h1></section>

  

  <section><p><em>Disclaimer: Not a tutorial.</em></p>
<blockquote>
<p>Not your average nuclear family.</p></blockquote>
<p>- Kolmogorov</p>
<blockquote>
<p>You won&rsquo;t believe these 5 exponential family tricks!</p></blockquote>
<p>- BuzzFeed</p>
<h2 id="quick-intro">
Quick Intro
<a href="#quick-intro" class="heading-anchor">#</a>
</h2>
<p>The exponential family is a collection of probability distributions that can all be cast in the same true form (technically there are a few different forms but they&rsquo;re equivalent under transformation). Surprisingly, the exponential family includes many of the probability distributions we know and love:</p>
<ul>
<li>Bernoulli</li>
<li>Binomial</li>
<li>Poisson</li>
<li>Exponential</li>
<li>Gamma</li>
<li>Beta</li>
<li>Normal</li>
</ul>
<p>(Aside, it&rsquo;s absurd that probability classes and textbooks often don&rsquo;t teach the exponential family given that, as we&rsquo;ll see, knowing about it can make things like computing moments much simpler.)</p>
<h2 id="exponential-family-forms">
Exponential Family Forms
<a href="#exponential-family-forms" class="heading-anchor">#</a>
</h2>
<p>To define the exponential family form, we assume that we want to express the probability density function (p.d.f.) of some random variable \( \mathbf{X} \) in terms of a \( d \)-dimensional parameter \( \boldsymbol{\theta} \). The exponential family form I learned first is,
\[ p(\mathbf{x} \mid \boldsymbol{\theta}) = h(\mathbf{x}) g(\boldsymbol{\theta}) \exp\left\{\sum_{i=1} w_i(\boldsymbol{\theta}) t_i(\mathbf{x})\right\} \]
where \( h(\mathbf{x}) \geq 0, g(\boldsymbol{\theta}) \geq 0. \) It&rsquo;s also important that the support of the distribution (the range of values to which it assigns non-zero probability density) as cast in this form does not depend on \( \boldsymbol{\theta} \).</p>
<p>We&rsquo;ll graduate to a &ldquo;true&rdquo; form later but I like this form as a starting point because I find it easier to transform distributions to. Let&rsquo;s do that for a few distributions now.</p>
<h3 id="welcoming-the-relatives">
Welcoming the relatives
<a href="#welcoming-the-relatives" class="heading-anchor">#</a>
</h3>
<h4 id="bernoulli">
Bernoulli
<a href="#bernoulli" class="heading-anchor">#</a>
</h4>
<p>A Bernoulli distribution takes a single parameter \( p \) and assigns probabilities to binary valued random variables. It has p.d.f.</p>
<p>\[
\begin{align}
P(x \mid p) &amp;= \begin{cases}
&amp; p \text{ if } x = 1, \\\
&amp; 1-p \text{ if } x = 0
\end{cases} \tag{1} \label{eq:bern1} \\\
&amp;= p^x \cdot (1-p)^(1-x). \tag{2} \label{eq:bern2}
\end{align}
\]
where equation \( \ref{eq:bern2} \) just combines the two pieces of equation \( \ref{eq:bern1} \) into one expression.</p>
<p>At first glance, it&rsquo;s surprising that we will be able to massage this into exponential family form. It has no \( \exp\{\cdot\} \) term after all. However, it turns out there&rsquo;s a trick that we&rsquo;ll use again and again to cast standard p.d.f.s into their exponential family forms.</p>
<p>If you want to try converting the Bernoulli p.d.f. into exponential family form before I do it and reveal the trick, you should do so now.</p>
<p>Here&rsquo;s the trick. Notice what happens if we take the logarithm of the original p.d.f.,
\[ \log\left( p^x \cdot (1-p)^(1-x) \right) = x \log(p) + (1-x) \log(1-p). \]
But we want \( P(x \mid p) \) not \( \log P(x \mid p) \), so we raise \( e \) to the \( \log P(x \mid p) \) and get,
\[ P(x \mid p) = \exp\left\{ x \log  p + (1-x) \log(1-p) \right\}. \]
Note that we have two terms in our \( \exp \left \{ \cdot \right \} \) term, but \( d \), the dimensionality of the parameter, \( p \), is 1, so this can&rsquo;t be our final form. To combine the two, we can taxe inspiration from the Bernoulli exponential family form and see if we can combine \( p \) and \( 1-p \) into a single term inside a \( \log \). It turns out we can. Distributing \( (n-x) \), we get
\[
\begin{align}
&amp;  \exp \left \{ x \log p + \log (1-p) - x \log (1-p) \right \} \\\
&amp;=  \exp \left \{ \log (1-p) \right \} \exp \left \{ x \log \left[ \frac{p}{(1-p)} \right] \right\} \\\
&amp;= \underbrace{1}_{h(x)} \cdot \overbrace{(1-p)}^{g(p)} \cdot \exp \left \{ \overbrace{x}^{t_1(x)} \cdot \underbrace{\log \left[ \frac{p}{(1-p)} \right]}_{w_1(p)} \right\}.
\end{align}
\]</p>
<h4 id="binomial">
Binomial
<a href="#binomial" class="heading-anchor">#</a>
</h4>
<p>The Binomial distribution can be thought of as assigning probabilities different numbers of successes in a series of \( n \) independent identically distributed Bernoulli random variables. For example, if we repeatedly flip a coin 5 times and count the number of times the coin lands on heads, the coin number of heads should be binomially distributed. The binomial distribution takes parameters \( n, p \) and has p.d.f.
\[ \begin{equation} P(k \mid p, n) = {n \choose k} p^k (1-p)^{n-k}. \tag{3} \label{eq:bin_pdf} \end{equation} \]</p>
<p>Notice that this looks quite similar to the Bernoulli p.d.f. To convert equation \( \ref{eq:bin_pdf} \) to exponential family form, let&rsquo;s first try our same \( \log \) \( \exp \) trick for everything after the binomial term,
\[ \begin{equation} P(k \mid p, n) = {n \choose k} \exp \left \{ k \log p + (n-k) \log (1-p) \right \}. \end{equation} \]</p>
<p>We now have two terms in our \( \exp \left \{ \cdot \right \} \) term, but \( d \), the dimensionality of the parameter, \( p \), is 1, so this can&rsquo;t be our final form. To combine the two, we can take inspiration from the Bernoulli exponential family form and see if we can combine \( p \) and \( 1-p \) into a single term inside a \( \log \). It turns out we can. Distributing \( (n-k) \), we get
\[
\begin{align}
&amp; {n \choose k} \exp \left \{ k \log p + n \log (1-p) - k \log (1-p) \right \} \\\
&amp;= {n \choose k} \exp \left \{ n \log (1-p) \right \} \exp \left \{ k \log \left[ \frac{p}{(1-p)} \right] \right\} \\\
&amp;= \underbrace{{n \choose k}}_{h(k)} \overbrace{(1-p)^{n}}^{g(p)} \cdot \exp \left \{ \overbrace{k}^{t_1(k)} \cdot \underbrace{\log \left[ \frac{p}{(1-p)} \right]}_{w_1(p)} \right\}.
\end{align}
\]</p>
<h4 id="normal--gaussian">
Normal / Gaussian
<a href="#normal--gaussian" class="heading-anchor">#</a>
</h4>
<p>The (univariate) normal distribution will be the last distribution we explicitly translate to exponential family form. Normal distributions pop up in all sorts of places but one intuition for them is that the normal distribution arises when you treat the sample mean of a large number of i.i.d. random variables as a random variable<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. The normal distribution takes mean \( \mu \) and variance \( \sigma^2 \) (\(\boldsymbol{\theta} = \begin{bmatrix} \mu &amp; \sigma^2 \end{bmatrix} \)) and has p.d.f.
\[
\begin{equation}
p(x \mid \mu, \sigma^2) = (2 \pi)^{(-1 / 2)} \sigma^{-1} \exp \left \{-\frac{1}{2 \sigma^2} (x - \mu)^2 \right \}.
\end{equation}
\]</p>
<p>To convert to exponential family form, let&rsquo;s expand out the quadratic term inside \( \exp \),
\[
\begin{equation}
p(x \mid \mu, \sigma^2) = (2 \pi)^{(-1 / 2)} \sigma^{-1} \exp \left \{-\frac{1}{2 \sigma^2} \left( x^2 - 2\mu x + \mu^2\right) \right \}.
\end{equation}
\]
Now we can pull out the piece of this term that only includes \( \mu, \sigma^2 \),
\[
\begin{equation}
p(x \mid \mu, \sigma^2) = \left( (2 \pi)^{(-1 / 2)} \right) \left( \sigma^{-1} \exp \left \{-\frac{\mu^2}{2 \sigma^2} \right\} \right) \exp \left \{\frac{\mu}{\sigma^2} x - \frac{1}{2\sigma^2}x^2 \right \}.
\end{equation}
\]</p>
<h3 id="true-forms">
True Forms
<a href="#true-forms" class="heading-anchor">#</a>
</h3>
<p>I always hate it when math books reference equations from many sections back in the book, so let&rsquo;s start by reproducing the exponential family form I gave above,
\[ p(\mathbf{x} \mid \boldsymbol{\theta}) = h(\mathbf{x}) g(\boldsymbol{\theta}) \exp\left\{\sum_{i=1} w_i(\boldsymbol{\theta}) t_i(\mathbf{x})\right\}. \]
To motivate the true form, look at the exponential term and notice that we can write it in vector notation, i.e. \( \mathbf{w}(\boldsymbol{\theta})^\top \mathbf{T}(\mathbf{x}) \). To be consistent with other treatments, I&rsquo;m renaming \( \mathbf{w}(\boldsymbol{\theta}) \) to  \( \boldsymbol{\eta}(\boldsymbol{\theta}) \), which I&rsquo;ll abbreviate as \( \boldsymbol{\eta} \). Making this transformation and also renaming \( \mathbf{c}(</p>
<h2 id="misc-properties">
Misc Properties
<a href="#misc-properties" class="heading-anchor">#</a>
</h2>
<ul>
<li>&lsquo;Curved&rsquo;</li>
</ul>
<h2 id="conjugate-priors">
Conjugate Priors
<a href="#conjugate-priors" class="heading-anchor">#</a>
</h2>
<h2 id="whats-not-in-the-exponential-family-and-why">
What&rsquo;s not in the exponential family and why?
<a href="#whats-not-in-the-exponential-family-and-why" class="heading-anchor">#</a>
</h2>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>This is the main result of the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a>, which I admittedly don&rsquo;t understand nearly as well as I&rsquo;d like to.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</section>
  <section><footer class="page-footer">
<hr />

<div class="previous-post" style="display:inline-block;">
  
  <a class="link-reverse" href="http://localhost:1313/post/2020-01-10-farewell-pa/?ref=footer">« Goodbye, Grandpa</a>
  
</div>

<div class="next-post", style="display:inline-block;float:right;">
  
  <a class="link-reverse" href="http://localhost:1313/post/2020-03-01-coffee-rct/?ref=footer">Decaf vs. regular coffee blinded experiment »</a>
  
</div>

<ul class="page-footer-menu">
  
  
  <li><a href="https://twitter.com/an1lam">Twitter</a></li>
  
  
  

  
  <li><a href="https://github.com/an1lam">GitHub</a></li>
  

  

  

  

  

  

  

  

  

  

  
  <li><a href="https://scholar.google.com/citations?user=Q6_3PJEAAAAJ">Google Scholar</a></li>
  
  
  
    <li><a href="https://github.com/an1lam"><i class='fa fa-github fa-2x'></i>  </a></li>
  
    <li><a href="https://twitter.com/an1lam"><i class='fa fa-twitter fa-2x'></i>  </a></li>
  
    <li><a href="mailto:stephenmalina@gmail.com"><i class='fa fa-envelope fa-2x'></i>  </a></li>
  
    <li><a href="https://stackoverflow.com/users/1631855/an1lam"><i class='fa fa-stack-overflow fa-2x'></i>  </a></li>
  
</ul>


<p>
  Powered by <a href="https://gohugo.io">Hugo</a> and the
  <a href="https://github.com/loikein/hugo-tufte">Tufte theme</a>.
</p>




</footer>
</section>
  <section><nav class="menu">
    <ul>
    
        <li><a href="http://localhost:1313/">Home</a></li>
    
        <li><a href="http://localhost:1313/about">About</a></li>
    
        <li><a href="http://localhost:1313/post">Post</a></li>
    
        <li><a href="http://localhost:1313/bets">Bets</a></li>
    
        <li><a href="http://localhost:1313/greatest-hits">Greatest Hits</a></li>
    
        <li><a href="http://localhost:1313/subscribe">Subscribe</a></li>
    
        <li><a href="http://localhost:1313/tags">Tags</a></li>
    
    </ul>
</nav>
</section>
</article>





</body>

</html>
