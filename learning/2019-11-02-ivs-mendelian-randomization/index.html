<!doctype html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />

  <title>Paper Review - IVs and Mendelian Randomization - Stephen Malina</title>
  <meta content='Paper Review - IVs and Mendelian Randomization - Stephen Malina' property='title' />
  <meta content='Paper Review - IVs and Mendelian Randomization - Stephen Malina' property='og:title' />


<meta property="og:description" content="Summary Detailed Notes 3 IV Requirements  IV must have a direct influence on the treatment IV must not covary with the unmeasured confounding that impacts the outcome IV must not have a direct influence on the outcome  Relevant considerations for deciding whether to do an IV analysis  Is there any unmeasured confounding?  If not, is the answer that we can just use a normal regression?  When is unmeasured confounding especially likely?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://an1lam.github.io/learning/2019-11-02-ivs-mendelian-randomization/" />


<meta property="article:published_time" content="2019-11-03T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2019-11-03T00:00:00&#43;00:00"/>








<meta name="generator" content="Hugo 0.57.2" />

<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet">
<style type="text/css">/*https://coolors.co/afd5aa-f0f2ef-a69f98-3d3d3d-8c6057*/
:root {
  --main-color: #8C6056; 
  --secondary-color: #AFD5AA;
  --logo-text-color: #fff;
  --body-text-color: #3d3d3d;
  --heading-text-color: #383838;
  --background-color: #fff;
}</style>
<link href='/css/tachyons.min.css' rel="stylesheet">
<link href='/css/styles.css' rel="stylesheet">


<link rel="icon" 
 
  href='/favicon.ico'

type="image/x-icon"/>

<link href='/feed.xml' rel="alternate" type="application/atom+xml" title="Stephen Malina" />
</head>
<body class="global-font">
  <nav class=" flex-ns justify-between border-box pa3 pl3-l pr2-l mt1 mt0-ns" id="navbar">
  <div class="flex">
    <a class="f4 fw6 ttu no-underline dim bg-main-color pv1 ph2 br2" id="site-title" href='/' title="Home">Stephen Malina</a>
  </div>
  
  <div class=" flex-ns mt2 mt0-ns pv1">
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/about' title="About">About</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/' title="Home">Home</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/learning/' title="Learning">Learning</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/post/' title="Posts">Posts</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/progress' title="The State of My Mind">The State of My Mind</a>
    
  </div>
  
</nav>
  
<main class="center mv4 content-width ph3">
  <div class="f3 fw6 heading-color heading-font post-title">Paper Review - IVs and Mendelian Randomization</div>
  <p class="silver f6 mt1 mb4 post-meta">
    <time>03 Nov 2019</time> 
     | 
    
    
    tags: [ <a href='/tags/causality' class="link silver">Causality</a> <a href='/tags/statistics' class="link silver">Statistics</a> <a href='/tags/notes' class="link silver">Notes</a>  ]
    
  </p>
  <div class="lh-copy post-content">

<h1 id="summary">Summary</h1>

<h1 id="detailed-notes">Detailed Notes</h1>

<h2 id="3-iv-requirements">3 IV Requirements</h2>

<ol>
<li>IV must have a direct influence on the treatment</li>
<li>IV must not covary with the unmeasured confounding that impacts the outcome</li>
<li>IV must not have a direct influence on the outcome</li>
</ol>

<h2 id="relevant-considerations-for-deciding-whether-to-do-an-iv-analysis">Relevant considerations for deciding whether to do an IV analysis</h2>

<ul>
<li>Is there any unmeasured confounding?

<ul>
<li>If not, is the answer that we can just use a normal regression?</li>
</ul></li>

<li><p>When is unmeasured confounding especially likely?</p>

<ul>
<li>If someone&rsquo;s trying to help the patient, it&rsquo;s likely there are some unrecorded features the helper took into account.</li>
<li>Ex: Doctor doesn&rsquo;t record that the patient smokes or eats french fries for lunch every day.</li>
</ul></li>

<li><p>What about if the IV assumptions are plausible but don&rsquo;t definitely hold?</p>

<ul>
<li>Going back to the NICU example, maybe people in this geography are exposed to pollution.</li>
<li>Ensembling IVs and finding results pointing in the same direction in all cases provides better evidence than controlling for one measured confounder in each study (because of unknown unknowns).
&gt; when different IVs are used, each IV identifies the average treatment effect for a different subgroup, so that we would only expect that findings from the different IVs would agree in direction if the average treatment effects for the different subgroups have the same direction</li>
</ul></li>

<li><p>Strength of the IVs</p>

<ul>
<li>Weak IVs -&gt; high variance treatment effect estimates even with large #s of participants</li>
</ul></li>
</ul>

<h2 id="examples-of-common-ivs">Examples of common IVs</h2>

<h3 id="ex-1-random-encouragement-trials">Ex. 1: Random Encouragement Trials</h3>

<ul>
<li>Doing an experiment to measure impact of smoking during pregnancy on birthweight</li>
<li>Staff person encourages subset of mothers who smoke to stop smoking using pamphlets, guidance, etc.</li>
<li>IV is whether the mother received encouragement</li>
<li>Criteria check:

<ol>
<li>In theory, influences the treatment (whether the mother smokes)</li>
<li>Not sure what the unmeasured confounding is here&hellip;</li>
<li>Can have direct effect on the outcome via affecting other similar decisions (drinking alcohol, other healthy behaviors)</li>
</ol></li>
</ul>

<h3 id="ex-2-distance-to-specialty-care-provider">Ex. 2: Distance to Specialty Care Provider</h3>

<ul>
<li>Say you want to understand how going to a specialist doctor vs. a general practitioner affects outcomes</li>
<li>You can use the fact that people will tend to go to closer doctors and select distance to each as an IV</li>
<li>Best for conditions that surprise you, since the more time you have to plan the less distance will impact your decision</li>
<li>But so many confounders&hellip; Maybe you can measure them?

<ul>
<li>Socioeconomic background&rsquo;s the obvious one, but at least it&rsquo;s known</li>
</ul></li>
<li>Criteria check:

<ol>
<li>Influences the treatment, especially for urgent care</li>
<li>Unmeasured confounding seems like a big risk</li>
<li></li>
</ol></li>
</ul>

<h3 id="ex-3-preference-based-ivs">Ex. 3: Preference-Based IVs</h3>

<ul>
<li>Take advantage of variation in medical practice patterns between groups</li>
<li>Ex: surgery vs. endovascular therapy for aneurysms using hospital as the IV</li>
</ul>

<h3 id="ex-4-genes-as-ivs-mendelian-randomization">Ex. 4: Genes as IVs (Mendelian Randomization)</h3>

<ul>
<li><strong>This is the reason we&rsquo;re interested in this</strong></li>

<li><p>Ex:</p>

<blockquote>
<p>Another example is that [32] studied the effect of maternal smoking on orofacial clefts in babies using genetic variants that increase the probability that a mother smokes as IVs.</p>
</blockquote></li>

<li><p><strong>Genes have to satisfy additional criteria to work as IVs</strong></p>

<ul>
<li>Genes can&rsquo;t be associated with population stratification

<ul>
<li><strong>Risks violating criteria 2</strong></li>
<li>Suppose we want use ALDH2 (Asian glow gene) to study the effect of alcohol consumption on high blood pressure<br /></li>
<li>This gene is highly correlated with Asian ancestry so only works as an IV if we&rsquo;ve fully measured the influence of ancestry</li>
<li>Q: What does &ldquo;measure&rdquo; mean in this context? Do we need to have enough subjects of Asian ancestry to actually regress on this attribute?</li>
</ul></li>
<li>No genetic linkage to other causal genes

<ul>
<li><strong>Risks violating criteria 2</strong></li>
<li>Genes close together on parental chromosomes tend to get inherited together</li>
<li>If subject inherits two genes that are causally associated with the outcome we want to measure but only use one as an IV, then we have unmeasured confounding</li>
</ul></li>
<li>No direct effect through &ldquo;pleiotropy&rdquo;

<ul>
<li><strong>Risks violating criteria 1</strong></li>
<li>Pleiotropy is where a gene has multiple functions</li>
</ul></li>
</ul></li>

<li><p>Additional papers on Mendelian Randomization:</p>

<ul>
<li><a href="https://www.ncbi.nlm.nih.gov/pubmed/17715159">Mendelian randomization as an instrumental variable approach to causal inference</a></li>
<li><a href="https://www.ncbi.nlm.nih.gov/pubmed/17886233/">Mendelian randomization: using genes as instruments for making causal inferences in epidemiology.</a></li>
</ul></li>
</ul>

<h2 id="formal-iv-assumptions-and-estimation-for-binary-ivs-and-treatments">Formal IV Assumptions and Estimation for Binary IVs and Treatments</h2>

<h3 id="setting">Setting</h3>

<ul>
<li>Notation note: bolded characters are vectors</li>
<li>\( N \): # of subjects</li>
<li>\( \mathbf{z} \): \( N \)-dimensional vector of IV assignments

<ul>
<li>\( z_i \in \{0, 1\} \) for all \( i \in [N] \)</li>
</ul></li>
<li>\( \mathbf{D^z} \in {0,1}^N \): \( N \)-dimensional vector of treatment assignments under IV assignment \( \mathbf{z} \)

<ul>
<li>Denote single treatment assignment with \( \mathbf{d} \)</li>
</ul></li>
<li>\( \mathbf{Y^{(z, d)}} \): \( N \)-dimensional vector of potential outcomes under IV assignment \( \mathbf{z} \) and treatment assignment \( \mathbf{d} \)

<ul>
<li>\( Y^{(\mathbf{z, d})}_i \) is the outcome subject \( i \) would have under IV assignment \( \mathbf{z} \) and treatment assignment \( \mathbf{d} \)</li>
<li>Assume we can write \( \mathbb{E}[Y] \) to denote expected value of outcome for a randomly sampled subject</li>
</ul></li>
<li>\( \mathbf{X} \in \mathbb{R}^{N \times \dots} \): observed covariates for subjects</li>
</ul>

<h3 id="5-formal-iv-assumptions">5 Formal IV Assumptions</h3>

<ol>
<li>Stable Unit Treatment Value Assumption</li>
<li>Criteria 1</li>
<li>Criteria 2</li>
<li>Criteria 3</li>
<li>Monotonicity
<strong>Note to self: Are these easier to encode in causal DAGs?</strong></li>
</ol>

<h3 id="stable-unit-treatment-value-assumption-sutva">Stable Unit Treatment Value Assumption (SUTVA)</h3>

<ul>
<li>Formal statement:
\[ \mathbf{z}_i = \mathbf{z}&rsquo;_i \rightarrow D^{\mathbf{z}}_i = D^{\mathbf{z&rsquo;}}_i \land \mathbf{d}_i = \mathbf{d}&rsquo;_i \rightarrow \mathbf{Y}^{(\mathbf{z, d})}_i = \mathbf{Y}^{(\mathbf{z&rsquo;, d&rsquo;})}_i \]</li>
<li>Plain English: if the IV assignments are the same, then the treatment assignments have to be the same. And if the treatment assignments are the same, then the potential outcomes have to be the same.</li>
</ul>

<h3 id="formal-versions-of-three-criteria">Formal Versions of Three Criteria</h3>

<ol>
<li>IV positive correlated with treatment:
\[ \mathbb{E}[D^1 \mid \mathbf{X}] &gt; \mathbb{E}[D^0 \mid \mathbf{X}] \]

<ul>
<li>Note: this seems like a weird way to write this&hellip;</li>
</ul></li>
<li>IV independent of unmeasured confounders: IV conditionally independent of \( \mathbf{D} \)s, \( \mathbf{Y} \)s on observed covariates</li>
<li>Exclusion restriction: \( Y^{(\mathbf{d, z})} = Y^d \)</li>
<li>These alone allow effect bounds to be determined but not point identified</li>
</ol>

<h3 id="compliance-classes-and-point-identification">Compliance classes and point identification</h3>

<ul>
<li>Always-takers, compliers, defiers, never-takers (self-explanatory)</li>
<li>How do you know if someone&rsquo;s a complier? Estimate them from other factors, presumably the covariates?</li>
<li>What do these classes mean in the context of genes as IVs?

<ul>
<li>Always-takers are people who do the thing regardless of whether they have the gene?</li>
<li>Compliers are people who do the thing if they have the gene</li>
<li>Defiers are people who only do the thing if they don&rsquo;t have the gene</li>
<li>Never-takers are people who never do the thing</li>
</ul></li>
</ul>

<h4 id="approach-1-to-enabling-point-identification-assume-monotonicity">Approach 1 to enabling point identification: assume monotonicity</h4>

<ul>
<li>Monotonicity means there are no defiers

<ul>
<li>Automatically satisfied if only subjects who receive the IV can get the treatment (ex: random encouragement)

<ul>
<li>Only compliers and never-takers because always-takers can&rsquo;t exist either since not everyone has opportunity to take the treatment</li>
</ul></li>
<li>However, this only tells us info about compliers if our outcomes are binary</li>
</ul></li>
<li>Average effect for compliers and always takers is identifiable in this approach (compliance average causal effect, CACE / LATE): \( \mathbb{E}(Y^1_i - Y^0_i \mid C_i = \text{complier}) \)</li>
</ul>

<h4 id="approach-2-to-enabling-point-identification-assume-effects-same-across-compliance-classes">Approach 2 to enabling point identification: assume effects same across compliance classes</h4>

<ul>
<li>Strongest version: assume expectation of difference between \( Y^0 \) and \( Y^1 \) uniform across compliance classes</li>
<li>In other words, treatment effects same amongst always takers and compliers conditional on the covariates</li>
</ul>

<h3 id="iv-estimation">IV Estimation</h3>

<ul>
<li>Horribly typeset proof that CACE is identified as described in approach 1</li>
<li>Can determine CASE using a 2-stage least squares (2SLS) process

<ul>
<li>Regress \( \mathbf{D} \) on \( \mathbf{Z} \) to get \( \hat{\mathbb{E}}(\mathbf{D} \mid \mathbf{Z}) \) (hat denotes sample mean)</li>
<li>Then regress \( Y \) on \( \hat{\mathbb{E}}(\mathbf{D} \mid \mathbf{Z}) \) to get an estimate of the CACE</li>
</ul></li>
<li>All of above assumes no observed covariates, but that&rsquo;s not very realistic</li>
<li>When we have observed covariates, we regress on \( \mathbf{Z} \) and \( \mathbf{X} \) (observed covariates)

<ul>
<li>Can guarantee estimate consistency if the effect of \( \mathbf{X} \) on the outcomes for compliers is linear and CACE given \( \mathbf{X} \) is the same for all \( \mathbf{X} \)</li>
<li>Impt for our stuff - what sort of covariates are going to be involved if we&rsquo;re trying to do the pioneer TF thing?</li>
</ul></li>
<li>Bias-variance trade-off: if IV is valid, asymptotically unbiased (multiple regression is not). If IV is not perfectly valid, 2SLS is asymptotically biased too but has better variance properties?

<ul>
<li>Look at <a href="https://www.ncbi.nlm.nih.gov/pubmed/23765683/">this paper</a>, which develops a tool for deciding when to use 2SLS vs. multiple regression</li>
</ul></li>
</ul>

<h2 id="case-studies">Case Studies</h2>

<h3 id="ex-2-treatment-in-a-randomized-trial-with-nonadherence">Ex. 2: Treatment in a randomized trial with nonadherence</h3>

<ul>
<li>Intention to treat (ITT) effect: effect of being assigned treatment vs. not</li>
<li>Nonadherence means ITT does not equal effect of <strong>receiving</strong> treatment vs. control</li>
<li>If nonadherence pattern differs between sample and actual target pop., we need to know the effect of <strong>receiving</strong> the treatment</li>
<li>Ex.: offer kids Vitamin A to see if mortality goes down

<ul>
<li>Some kids didn&rsquo;t take the pills (still factored into ITT estimate)</li>
<li>Notably different from actual real-world intervention of fortifying food</li>
</ul></li>
<li>Ex.: want to know failure rate of contraception if youactually use it</li>
<li>What if we just estimate \(\hat{\mathbb{E}}(Y \mid Z=1, D=1) - \hat{\mathbf{E}}(Y \mid Z=0, D=0)\) instead?

<ul>
<li>Can be systematically biased if defiance correlated with some other trait like having a worse diet</li>
<li>Instead, treatement assignment can be the IV</li>
</ul></li>
<li>Why?
&gt;  the denominator of (4) is an estimate of the proportion of compliers.

<ul>
<li>Isn&rsquo;t the estimate of proportion of compliers really
\[ \frac{1}{2}(\hat{\mathbb{E}}[D_i \mid Z_i = 1] + (1-\hat{\mathbb{E}}[D_i \mid Z_i = 1])) \]</li>
</ul></li>
</ul>
</div>
</main>
 






<div class="tl fixed list-pages lh-copy" id="contents-list"></div>



<div class="pagination tc tr-l db fixed-l bottom-2-l right-2-l mb3 mb0-l">
  
<a id="scroll-to-top" class="f6 o-0 link br2 ph2 pv1 mb1 bg-main-color pointer" onclick="topFunction()" style="color: #fff; visibility: hidden; display: none; transition: opacity .5s, visibility .5s;" title="back to top">back to top</a>
<br>
  <p class="mb0 mt2">
  <a href="https://an1lam.github.io/learning/2019-05-20-linear-algebra-done-right-ch6-notes/">prev post</a>
  <a href="https://an1lam.github.io/learning/2019-11-08-causal-inference/">next post</a>
  </p>
</div>

  <footer class="content-width mt0 mt5-l mb4 f6 center ph3 gray tc tl-l">
  <hr class="dn db-l ml0-l gray w3"><br>
  Powered by <a href="https://gohugo.io/" target="_blank" class="link gray dim">Hugo</a>, based on the <a href="https://github.com/lingxz/er" target="_blank" class="link gray dim">Er</a> theme. <br>
  
</footer>
  



<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<style>.is-active-link::before { background-color: var(--secondary-color); }</style>




<script type="text/javascript">
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;

  
  if (document.getElementById("tag-cloud") !== null) { 
    if (prevScrollpos > currentScrollPos) { 
      document.getElementById("tag-cloud").style.visibility = "visible";
      document.getElementById("tag-cloud").style.opacity = "1";
    } else {
      document.getElementById("tag-cloud").style.visibility = "hidden";
      document.getElementById("tag-cloud").style.opacity = "0";
    }
  }
  

  
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
      document.getElementById("scroll-to-top").style.display = "inline";
      document.getElementById("scroll-to-top").style.visibility = "visible";
      document.getElementById("scroll-to-top").style.opacity = "1";
  } else {
      document.getElementById("scroll-to-top").style.visibility = "hidden";
      document.getElementById("scroll-to-top").style.opacity = "0";
  }
  
  prevScrollpos = currentScrollPos;
}


function topFunction() {
  document.body.scrollTop = 0; 
  document.documentElement.scrollTop = 0; 
}






if (document.getElementById("contents-list") !== null && document.getElementsByClassName("post-content").length !== 0) { 
  tocbot.init({
    
    tocSelector: '#contents-list',
    
    contentSelector: '.post-content',
    
    headingSelector: 'h1, h2, h3',
  });
}


</script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css">
<script>
  renderMathInElement(document.body,
    {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false},
        ]
    }
  );

  var inlineMathArray = document.querySelectorAll("script[type='math/tex']");
  for (var i = 0; i < inlineMathArray.length; i++) {
    var inlineMath = inlineMathArray[i];
    var tex = inlineMath.innerText || inlineMath.textContent;
    var replaced = document.createElement("span");
    replaced.innerHTML = katex.renderToString(tex, {displayMode: false});
    inlineMath.parentNode.replaceChild(replaced, inlineMath);
  }

  var displayMathArray = document.querySelectorAll("script[type='math/tex; mode=display']");
  for (var i = 0; i < displayMathArray.length; i++) {
    var displayMath = displayMathArray[i];
    var tex = displayMath.innerHTML;
    var replaced = document.createElement("span");
    replaced.innerHTML = katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
    displayMath.parentNode.replaceChild(replaced, displayMath);
  }
</script>


</body>
</html>